<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>সাহরী ও ইফতারের সময়সূচি</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Noto Sans Bengali', sans-serif;
            background-color: #0f172a;
            color: #f1f5f9;
        }
        ::selection {
            background-color: rgba(245, 158, 11, 0.3);
        }
        .backdrop-blur-xl {
            backdrop-filter: blur(24px);
        }
        .backdrop-blur-md {
            backdrop-filter: blur(12px);
        }
        .backdrop-blur-sm {
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body class="min-h-screen relative overflow-x-hidden selection:bg-amber-500/30 text-slate-100">

    <!-- Background Ornaments -->
    <div class="absolute top-0 left-0 w-full h-96 bg-gradient-to-b from-amber-900/20 to-transparent pointer-events-none -z-10"></div>
    <div class="absolute -top-40 -right-40 w-96 h-96 bg-amber-600/10 rounded-full blur-3xl pointer-events-none -z-10"></div>
    <div class="absolute top-1/3 -left-40 w-80 h-80 bg-emerald-600/10 rounded-full blur-3xl pointer-events-none -z-10"></div>

    <main class="max-w-5xl mx-auto px-4 py-8 relative z-10">
        
        <!-- Header Section -->
        <header class="text-center mb-10 space-y-4">
            <div class="flex flex-col items-center justify-center space-y-2">
                <div class="w-16 h-16 rounded-full bg-slate-800/80 border border-slate-700 p-2 flex items-center justify-center shadow-lg">
                    <i data-lucide="moon" class="w-8 h-8 text-amber-400" fill="currentColor"></i>
                </div>
                <h2 class="text-amber-400 font-medium tracking-wider text-sm">ধর্ম বিষয়ক মন্ত্রণালয় • ইসলামিক ফাউন্ডেশন</h2>
                <h1 class="text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-amber-200 to-amber-500 pb-1">
                    সাহরী ও ইফতারের সময়সূচি
                </h1>
            </div>
            
            <div class="flex flex-wrap items-center justify-center gap-4 text-slate-300 mt-4">
                <div class="flex items-center gap-1.5 bg-slate-800/50 backdrop-blur-md px-4 py-1.5 rounded-full border border-slate-700/50 shadow-sm">
                    <i data-lucide="map-pin" class="w-4 h-4 text-emerald-400"></i>
                    <span class="font-semibold tracking-wide text-white">বরিশাল জেলা</span>
                </div>
                <div class="flex items-center gap-1.5 bg-slate-800/50 backdrop-blur-md px-4 py-1.5 rounded-full border border-slate-700/50 shadow-sm">
                    <i data-lucide="calendar" class="w-4 h-4 text-blue-400"></i>
                    <span>১৪৪৭ হিজরী • ২০২৬ খ্রিস্টাব্দ</span>
                </div>
            </div>
        </header>

        <!-- Next Event & Today Widget -->
        <div class="mb-10 grid gap-6 md:grid-cols-2">
            <!-- Live Countdown Card -->
            <div class="bg-gradient-to-br from-slate-800/80 to-slate-900/80 backdrop-blur-xl border border-slate-700/50 rounded-3xl p-6 shadow-2xl relative overflow-hidden group">
                <div class="absolute top-0 right-0 w-32 h-32 bg-amber-500/10 rounded-full blur-2xl group-hover:bg-amber-500/20 transition-all"></div>
                
                <h3 class="text-slate-400 text-sm font-medium mb-1 uppercase tracking-wider flex items-center gap-2">
                    <i data-lucide="clock" class="w-4 h-4"></i> বর্তমান সময়: <span id="current-time">--:--:--</span>
                </h3>
                
                <!-- Event Active -->
                <div id="next-event-container" class="mt-4 hidden">
                    <div class="flex items-center gap-3 mb-2">
                        <div id="event-icon-container"></div>
                        <h2 id="next-event-title" class="text-2xl font-bold text-white">--</h2>
                    </div>
                    <div id="next-event-time" class="text-4xl md:text-5xl font-black bg-clip-text text-transparent bg-gradient-to-r from-white to-slate-400 font-mono tracking-tight py-2">
                        -- ঘন্টা -- মিনিট -- সেকেন্ড
                    </div>
                </div>

                <!-- Event Inactive -->
                <div id="no-event-container" class="mt-4 text-2xl font-bold text-slate-300 hidden">
                    রমজান মাস শেষে বা শুরু হয়নি
                </div>
            </div>

            <!-- Today's Times Card -->
            <div id="today-widget" class="hidden bg-slate-800/50 backdrop-blur-xl border border-amber-500/30 rounded-3xl p-6 shadow-[0_0_30px_rgba(245,158,11,0.1)] flex-col justify-center">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-amber-400 font-bold text-lg flex items-center gap-2">
                        <i data-lucide="star" class="w-5 h-5" fill="currentColor"></i> আজকের সময়সূচি
                    </h3>
                    <span id="today-date-badge" class="bg-amber-500/20 text-amber-300 px-3 py-1 rounded-full text-sm font-medium border border-amber-500/20">
                        --
                    </span>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-slate-900/50 rounded-2xl p-4 border border-slate-700/50 flex flex-col items-center text-center">
                        <span class="text-slate-400 text-sm mb-1">সাহরীর শেষ সময়</span>
                        <span id="today-sehri" class="text-3xl font-bold text-white">--:--</span>
                    </div>
                    <div class="bg-slate-900/50 rounded-2xl p-4 border border-slate-700/50 flex flex-col items-center text-center">
                        <span class="text-slate-400 text-sm mb-1">ইফতারের সময়</span>
                        <span id="today-iftar" class="text-3xl font-bold text-white">--:--</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Table Controls -->
        <div class="flex flex-col sm:flex-row items-center justify-between gap-4 mb-6">
            <h3 class="text-xl font-semibold text-slate-200">সম্পূর্ণ সময়সূচি</h3>
            
            <!-- Ashra Filters -->
            <div class="flex flex-wrap justify-center bg-slate-800/80 p-1 rounded-xl border border-slate-700/50 backdrop-blur-sm gap-1">
                <button onclick="setFilter('all')" id="btn-filter-all" class="px-4 py-2 rounded-lg text-sm font-medium transition-all bg-slate-700 text-white shadow-sm">
                    সব
                </button>
                <button onclick="setFilter(1)" id="btn-filter-1" class="px-4 py-2 rounded-lg text-sm font-medium transition-all text-slate-400 hover:text-slate-200">
                    রহমত (১-১০)
                </button>
                <button onclick="setFilter(2)" id="btn-filter-2" class="px-4 py-2 rounded-lg text-sm font-medium transition-all text-slate-400 hover:text-slate-200">
                    মাগফিরাত (১১-২০)
                </button>
                <button onclick="setFilter(3)" id="btn-filter-3" class="px-4 py-2 rounded-lg text-sm font-medium transition-all text-slate-400 hover:text-slate-200">
                    নাজাত (২১-৩০)
                </button>
            </div>
        </div>

        <!-- Main Data Table -->
        <div class="bg-slate-800/40 backdrop-blur-md rounded-2xl border border-slate-700/50 shadow-xl overflow-hidden mb-10">
            <div class="overflow-x-auto">
                <table class="w-full text-left border-collapse min-w-[600px]">
                    <thead>
                        <tr class="bg-slate-800/80 text-slate-300 text-sm md:text-base border-b border-slate-700/50">
                            <th class="px-4 py-4 font-semibold text-center w-16">রমজান</th>
                            <th class="px-4 py-4 font-semibold">তারিখ</th>
                            <th class="px-4 py-4 font-semibold text-emerald-400">সাহরীর শেষ সময়</th>
                            <th class="px-4 py-4 font-semibold text-slate-400">ফজরের আযান</th>
                            <th class="px-4 py-4 font-semibold text-amber-400">ইফতারের সময়</th>
                            <th class="px-4 py-4 font-semibold hidden md:table-cell text-center">আশরা</th>
                        </tr>
                    </thead>
                    <tbody id="table-body" class="divide-y divide-slate-700/30">
                        <!-- Table rows will be generated here -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Footer Notes -->
        <div class="bg-slate-800/30 border border-slate-700/50 rounded-2xl p-6 text-slate-400 text-sm leading-relaxed space-y-4 shadow-sm backdrop-blur-sm">
            <p class="flex items-center gap-2 text-amber-400/80 font-medium">
                <i data-lucide="star" class="w-4 h-4" fill="currentColor"></i> ১লা রমযান চাঁদ দেখার উপর নির্ভরশীল।
            </p>
            <div class="flex gap-3 items-start">
                <i data-lucide="alert-circle" class="w-5 h-5 text-slate-500 shrink-0 mt-0.5"></i>
                <p class="text-justify">
                    <strong class="text-slate-300 font-medium">নোট:</strong> যেটি সাহরীর শেষ সময় সেটিই মূলত সালাতুল ফজরের শুরু সময়। কিন্তু যেহেতু এই সময়সূচিটি পুরো জেলার জন্য প্রস্তুত করা হয়েছে, আর জেলার এক প্রান্ত থেকে আরেক প্রান্তের সময়ের মাঝে ব্যবধান হয়ে থাকে, তাই পুরো জেলার জন্য একটি সময়সূচি প্রস্তুত করতে এ পদ্ধতি অবলম্বন করতে হয়েছে যে, সাহরীর জন্য জেলার পূর্ব প্রান্তের সুবহে সাদিকের সময় (সেকেন্ড বাদ দিয়ে) উল্লেখ করা হয়েছে। ফজরের আযানের জন্য জেলার পশ্চিম প্রান্তের সুবহে সাদিকের সময় (সেকেন্ডকে পূর্ণ মিনিট করে) উল্লেখ করা হয়েছে এবং ইফতারের জন্য জেলার পশ্চিম প্রান্তের সূর্যাস্তের সময় (সেকেন্ডকে পূর্ণ মিনিট করে) উল্লেখ করা হয়েছে।
                </p>
            </div>
            <p class="text-center italic text-slate-500 pt-4 border-t border-slate-700/50">
                (বি.দ্র. বায়তুল মোকাররম জাতীয় মসজিদের খতীব মহোদয়ের নেতৃত্বে দেশের শীর্ষ মুফতিয়ানে কেরাম কর্তৃক প্রণীত)
            </p>
        </div>

    </main>

    <script>
        // Data Extraction
        const ramadanData = [
            { dayBn: '০১', dateBn: '১৯ ফেব্রুয়ারি', sehriBn: '৫:১১', fajrBn: '৫:১৫', iftarBn: '৫:৫৯', enDate: '2026-02-19', sehriEn: '05:11', iftarEn: '17:59', ashra: 1 },
            { dayBn: '০২', dateBn: '২০ ফেব্রুয়ারি', sehriBn: '৫:১০', fajrBn: '৫:১৪', iftarBn: '৫:৫৯', enDate: '2026-02-20', sehriEn: '05:10', iftarEn: '17:59', ashra: 1 },
            { dayBn: '০৩', dateBn: '২১ ফেব্রুয়ারি', sehriBn: '৫:০৯', fajrBn: '৫:১৩', iftarBn: '৬:০০', enDate: '2026-02-21', sehriEn: '05:09', iftarEn: '18:00', ashra: 1 },
            { dayBn: '০৪', dateBn: '২২ ফেব্রুয়ারি', sehriBn: '৫:০৯', fajrBn: '৫:১৩', iftarBn: '৬:০০', enDate: '2026-02-22', sehriEn: '05:09', iftarEn: '18:00', ashra: 1 },
            { dayBn: '০৫', dateBn: '২৩ ফেব্রুয়ারি', sehriBn: '৫:০৮', fajrBn: '৫:১২', iftarBn: '৬:০১', enDate: '2026-02-23', sehriEn: '05:08', iftarEn: '18:01', ashra: 1 },
            { dayBn: '০৬', dateBn: '২৪ ফেব্রুয়ারি', sehriBn: '৫:০৭', fajrBn: '৫:১১', iftarBn: '৬:০১', enDate: '2026-02-24', sehriEn: '05:07', iftarEn: '18:01', ashra: 1 },
            { dayBn: '০৭', dateBn: '২৫ ফেব্রুয়ারি', sehriBn: '৫:০৭', fajrBn: '৫:১০', iftarBn: '৬:০২', enDate: '2026-02-25', sehriEn: '05:07', iftarEn: '18:02', ashra: 1 },
            { dayBn: '০৮', dateBn: '২৬ ফেব্রুয়ারি', sehriBn: '৫:০৬', fajrBn: '৫:১০', iftarBn: '৬:০২', enDate: '2026-02-26', sehriEn: '05:06', iftarEn: '18:02', ashra: 1 },
            { dayBn: '০৯', dateBn: '২৭ ফেব্রুয়ারি', sehriBn: '৫:০৫', fajrBn: '৫:০৯', iftarBn: '৬:০৩', enDate: '2026-02-27', sehriEn: '05:05', iftarEn: '18:03', ashra: 1 },
            { dayBn: '১০', dateBn: '২৮ ফেব্রুয়ারি', sehriBn: '৫:০৪', fajrBn: '৫:০৮', iftarBn: '৬:০৩', enDate: '2026-02-28', sehriEn: '05:04', iftarEn: '18:03', ashra: 1 },
            { dayBn: '১১', dateBn: '০১ মার্চ',    sehriBn: '৫:০৪', fajrBn: '৫:০৭', iftarBn: '৬:০৩', enDate: '2026-03-01', sehriEn: '05:04', iftarEn: '18:03', ashra: 2 },
            { dayBn: '১২', dateBn: '০২ মার্চ',    sehriBn: '৫:০৩', fajrBn: '৫:০৭', iftarBn: '৬:০৪', enDate: '2026-03-02', sehriEn: '05:03', iftarEn: '18:04', ashra: 2 },
            { dayBn: '১৩', dateBn: '০৩ মার্চ',    sehriBn: '৫:০২', fajrBn: '৫:০৬', iftarBn: '৬:০৪', enDate: '2026-03-03', sehriEn: '05:02', iftarEn: '18:04', ashra: 2 },
            { dayBn: '১৪', dateBn: '০৪ মার্চ',    sehriBn: '৫:০১', fajrBn: '৫:০৫', iftarBn: '৬:০৫', enDate: '2026-03-04', sehriEn: '05:01', iftarEn: '18:05', ashra: 2 },
            { dayBn: '১৫', dateBn: '০৫ মার্চ',    sehriBn: '৫:০০', fajrBn: '৫:০৪', iftarBn: '৬:০৫', enDate: '2026-03-05', sehriEn: '05:00', iftarEn: '18:05', ashra: 2 },
            { dayBn: '১৬', dateBn: '০৬ মার্চ',    sehriBn: '৪:৫৯', fajrBn: '৫:০৩', iftarBn: '৬:০৬', enDate: '2026-03-06', sehriEn: '04:59', iftarEn: '18:06', ashra: 2 },
            { dayBn: '১৭', dateBn: '০৭ মার্চ',    sehriBn: '৪:৫৯', fajrBn: '৫:০২', iftarBn: '৬:০৬', enDate: '2026-03-07', sehriEn: '04:59', iftarEn: '18:06', ashra: 2 },
            { dayBn: '১৮', dateBn: '০৮ মার্চ',    sehriBn: '৪:৫৮', fajrBn: '৫:০১', iftarBn: '৬:০৭', enDate: '2026-03-08', sehriEn: '04:58', iftarEn: '18:07', ashra: 2 },
            { dayBn: '১৯', dateBn: '০৯ মার্চ',    sehriBn: '৪:৫৭', fajrBn: '৫:০১', iftarBn: '৬:০৭', enDate: '2026-03-09', sehriEn: '04:57', iftarEn: '18:07', ashra: 2 },
            { dayBn: '২০', dateBn: '১০ মার্চ',    sehriBn: '৪:৫৬', fajrBn: '৫:০০', iftarBn: '৬:০৭', enDate: '2026-03-10', sehriEn: '04:56', iftarEn: '18:07', ashra: 2 },
            { dayBn: '২১', dateBn: '১১ মার্চ',    sehriBn: '৪:৫৫', fajrBn: '৪:৫৯', iftarBn: '৬:০৮', enDate: '2026-03-11', sehriEn: '04:55', iftarEn: '18:08', ashra: 3 },
            { dayBn: '২২', dateBn: '১২ মার্চ',    sehriBn: '৪:৫৪', fajrBn: '৪:৫৮', iftarBn: '৬:০৮', enDate: '2026-03-12', sehriEn: '04:54', iftarEn: '18:08', ashra: 3 },
            { dayBn: '২৩', dateBn: '১৩ মার্চ',    sehriBn: '৪:৫৩', fajrBn: '৪:৫৭', iftarBn: '৬:০৯', enDate: '2026-03-13', sehriEn: '04:53', iftarEn: '18:09', ashra: 3 },
            { dayBn: '২৪', dateBn: '১৪ মার্চ',    sehriBn: '৪:৫২', fajrBn: '৪:৫৬', iftarBn: '৬:০৯', enDate: '2026-03-14', sehriEn: '04:52', iftarEn: '18:09', ashra: 3 },
            { dayBn: '২৫', dateBn: '১৫ মার্চ',    sehriBn: '৪:৫১', fajrBn: '৪:৫৫', iftarBn: '৬:০৯', enDate: '2026-03-15', sehriEn: '04:51', iftarEn: '18:09', ashra: 3 },
            { dayBn: '২৬', dateBn: '১৬ মার্চ',    sehriBn: '৪:৫০', fajrBn: '৪:৫৪', iftarBn: '৬:১০', enDate: '2026-03-16', sehriEn: '04:50', iftarEn: '18:10', ashra: 3 },
            { dayBn: '২৭', dateBn: '১৭ মার্চ',    sehriBn: '৪:৪৯', fajrBn: '৪:৫৩', iftarBn: '৬:১০', enDate: '2026-03-17', sehriEn: '04:49', iftarEn: '18:10', ashra: 3 },
            { dayBn: '২৮', dateBn: '১৮ মার্চ',    sehriBn: '৪:৪৮', fajrBn: '৪:৫২', iftarBn: '৬:১০', enDate: '2026-03-18', sehriEn: '04:48', iftarEn: '18:10', ashra: 3 },
            { dayBn: '২৯', dateBn: '১৯ মার্চ',    sehriBn: '৪:৪৭', fajrBn: '৪:৫১', iftarBn: '৬:১১', enDate: '2026-03-19', sehriEn: '04:47', iftarEn: '18:11', ashra: 3 },
            { dayBn: '৩০', dateBn: '২০ মার্চ',    sehriBn: '৪:৪৬', fajrBn: '৪:৫০', iftarBn: '৬:১১', enDate: '2026-03-20', sehriEn: '04:46', iftarEn: '18:11', ashra: 3 },
        ];

        // State variables
        let activeAshraFilter = 'all';
        let currentTimeObj = new Date();
        let currentTodayData = null;

        // Utility functions
        const englishToBengaliNumber = (engNumStr) => {
            const bnNumbers = ['০', '১', '২', '৩', '৪', '৫', '৬', '৭', '৮', '৯'];
            return engNumStr.toString().split('').map(char => {
                if (char >= '0' && char <= '9') return bnNumbers[parseInt(char)];
                return char;
            }).join('');
        };

        const formatTimeLeft = (targetDate) => {
            if (!targetDate) return '';
            const diffMs = targetDate - new Date();
            if (diffMs <= 0) return '০ ঘন্টা ০ মিনিট';
            
            const hours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diffMs % (1000 * 60)) / 1000);

            return `${englishToBengaliNumber(hours)} ঘন্টা ${englishToBengaliNumber(minutes)} মিনিট ${englishToBengaliNumber(seconds)} সেকেন্ড`;
        };

        const getAshraBadge = (ashraNum) => {
            switch(ashraNum) {
                case 1: return { text: 'রহমত', color: 'bg-emerald-500/20 text-emerald-300 border-emerald-500/30' };
                case 2: return { text: 'মাগফিরাত', color: 'bg-blue-500/20 text-blue-300 border-blue-500/30' };
                case 3: return { text: 'নাজাত', color: 'bg-amber-500/20 text-amber-300 border-amber-500/30' };
                default: return { text: '', color: '' };
            }
        };

        // Filter Logic
        function setFilter(filter) {
            activeAshraFilter = filter;
            
            // Reset button styles
            ['all', 1, 2, 3].forEach(f => {
                const btn = document.getElementById(`btn-filter-${f}`);
                if (btn) {
                    btn.className = "px-4 py-2 rounded-lg text-sm font-medium transition-all text-slate-400 hover:text-slate-200";
                }
            });

            // Set active button style
            const activeBtn = document.getElementById(`btn-filter-${filter}`);
            if (activeBtn) {
                if (filter === 'all') {
                    activeBtn.className = "px-4 py-2 rounded-lg text-sm font-medium transition-all bg-slate-700 text-white shadow-sm";
                } else if (filter === 1) {
                    activeBtn.className = "px-4 py-2 rounded-lg text-sm font-medium transition-all bg-emerald-500/20 text-emerald-400 shadow-sm";
                } else if (filter === 2) {
                    activeBtn.className = "px-4 py-2 rounded-lg text-sm font-medium transition-all bg-blue-500/20 text-blue-400 shadow-sm";
                } else if (filter === 3) {
                    activeBtn.className = "px-4 py-2 rounded-lg text-sm font-medium transition-all bg-amber-500/20 text-amber-400 shadow-sm";
                }
            }
            
            renderTable();
        }

        // Render Table
        function renderTable() {
            const tableBody = document.getElementById('table-body');
            let html = '';

            const filteredData = activeAshraFilter === 'all' 
                ? ramadanData 
                : ramadanData.filter(d => d.ashra === activeAshraFilter);

            filteredData.forEach(day => {
                const isToday = currentTodayData && currentTodayData.dayBn === day.dayBn;
                const ashraBadge = getAshraBadge(day.ashra);
                
                let dayBnHtml = '';
                if (day.dayBn === '০১') {
                    dayBnHtml = `<span class="flex items-center justify-center gap-1 text-amber-400">
                                    <i data-lucide="star" class="w-3 h-3 fill-amber-400" fill="currentColor"></i> ${day.dayBn}
                                 </span>`;
                } else {
                    dayBnHtml = `<span class="${isToday ? 'text-amber-400 font-bold' : 'text-slate-300'}">${day.dayBn}</span>`;
                }

                html += `
                    <tr class="transition-colors hover:bg-slate-700/30 ${isToday ? 'bg-amber-900/20 hover:bg-amber-900/30 relative' : ''}">
                        <td class="px-4 py-3.5 text-center font-medium">
                            ${isToday ? '<div class="absolute left-0 top-0 bottom-0 w-1 bg-amber-500 rounded-r-full"></div>' : ''}
                            ${dayBnHtml}
                        </td>
                        <td class="px-4 py-3.5 whitespace-nowrap">
                            <span class="${isToday ? 'text-white font-semibold' : 'text-slate-200'}">${day.dateBn}</span>
                        </td>
                        <td class="px-4 py-3.5 font-mono text-lg">
                            <span class="${isToday ? 'text-emerald-300 font-bold' : 'text-emerald-400/90'}">${day.sehriBn}</span>
                        </td>
                        <td class="px-4 py-3.5 font-mono text-lg text-slate-400">
                            ${day.fajrBn}
                        </td>
                        <td class="px-4 py-3.5 font-mono text-lg">
                            <span class="${isToday ? 'text-amber-300 font-bold' : 'text-amber-400/90'}">${day.iftarBn}</span>
                        </td>
                        <td class="px-4 py-3.5 hidden md:table-cell text-center">
                            <span class="inline-block px-2.5 py-1 text-xs rounded-full border ${ashraBadge.color}">
                                ${ashraBadge.text}
                            </span>
                        </td>
                    </tr>
                `;
            });

            tableBody.innerHTML = html;
            lucide.createIcons();
        }

        // Timer Logic
        function updateClock() {
            const now = new Date();
            currentTimeObj = now;
            
            // Update live clock
            document.getElementById('current-time').innerText = englishToBengaliNumber(now.toLocaleTimeString('bn-BD', { hour: '2-digit', minute: '2-digit', second:'2-digit' }));

            // Format current date to YYYY-MM-DD local time
            const tzOffset = now.getTimezoneOffset() * 60000;
            const localISOTime = (new Date(now.getTime() - tzOffset)).toISOString().split('T')[0];
            
            const todayData = ramadanData.find(d => d.enDate === localISOTime);
            
            // Update table if day changed
            if ((currentTodayData && !todayData) || (!currentTodayData && todayData) || (currentTodayData && todayData && currentTodayData.enDate !== todayData.enDate)) {
                currentTodayData = todayData;
                renderTable();
            }

            let nextEvent = null;

            if (todayData) {
                // Show today widget
                document.getElementById('today-widget').classList.remove('hidden');
                document.getElementById('today-widget').classList.add('flex');
                document.getElementById('today-date-badge').innerText = `${todayData.dayBn} রমজান • ${todayData.dateBn}`;
                document.getElementById('today-sehri').innerText = todayData.sehriBn;
                document.getElementById('today-iftar').innerText = todayData.iftarBn;

                // Parse today's Sehri and Iftar into Date objects
                const sehriParts = todayData.sehriEn.split(':');
                const sehriTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), parseInt(sehriParts[0]), parseInt(sehriParts[1]), 0);
                
                const iftarParts = todayData.iftarEn.split(':');
                const iftarTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), parseInt(iftarParts[0]), parseInt(iftarParts[1]), 0);

                if (now < sehriTime) {
                    nextEvent = { name: 'সাহরী শেষ হতে বাকি', time: sehriTime, isSehri: true };
                } else if (now < iftarTime) {
                    nextEvent = { name: 'ইফতারের বাকি', time: iftarTime, isSehri: false };
                } else {
                    // Look at tomorrow's sehri
                    const tomorrow = new Date(now);
                    tomorrow.setDate(tomorrow.getDate() + 1);
                    const tomorrowISOTime = new Date(tomorrow.getTime() - tzOffset).toISOString().split('T')[0];
                    const tomorrowData = ramadanData.find(d => d.enDate === tomorrowISOTime);
                    
                    if (tomorrowData) {
                        const tomSehriParts = tomorrowData.sehriEn.split(':');
                        const tomSehriTime = new Date(tomorrow.getFullYear(), tomorrow.getMonth(), tomorrow.getDate(), parseInt(tomSehriParts[0]), parseInt(tomSehriParts[1]), 0);
                        nextEvent = { name: 'আগামীকাল সাহরীর বাকি', time: tomSehriTime, isSehri: true };
                    }
                }
            } else {
                // Hide today widget
                document.getElementById('today-widget').classList.add('hidden');
                document.getElementById('today-widget').classList.remove('flex');
                
                if (now < new Date('2026-02-19')) {
                    const firstDay = new Date(2026, 1, 19, 5, 11, 0); // Month is 0-indexed (1 = Feb)
                    nextEvent = { name: 'প্রথম সাহরীর বাকি', time: firstDay, isSehri: true};
                }
            }

            // Update DOM with Next Event Data
            if (nextEvent) {
                document.getElementById('next-event-container').classList.remove('hidden');
                document.getElementById('no-event-container').classList.add('hidden');
                
                document.getElementById('next-event-title').innerText = nextEvent.name;
                document.getElementById('next-event-time').innerText = formatTimeLeft(nextEvent.time);
                
                // Update icon dynamically
                const iconContainer = document.getElementById('event-icon-container');
                if (nextEvent.isSehri) {
                    iconContainer.innerHTML = '<i data-lucide="moon" class="w-6 h-6 text-emerald-400"></i>';
                } else {
                    iconContainer.innerHTML = '<i data-lucide="sun" class="w-6 h-6 text-amber-400"></i>';
                }
                lucide.createIcons(); // re-initialize icons after DOM update
            } else {
                document.getElementById('next-event-container').classList.add('hidden');
                document.getElementById('no-event-container').classList.remove('hidden');
            }
        }

        // Initialize App
        lucide.createIcons();
        updateClock(); // Initial call
        renderTable();
        setInterval(updateClock, 1000); // Start timer

    </script>
</body>
</html>
